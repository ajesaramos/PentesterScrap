import sys
import requests


def main():

    if len(sys.argv) < 2:
        print("Usage: python script.py <search_term>")
        return

    search_term = sys.argv[1].lower()
    
    try:
        r = requests.get("https://pentester.land/writeups.json")
        r.raise_for_status()
        writeups = r.json()["data"]
    except requests.RequestException as e:
        print(f"Error fetching data: {e}")
        return
    except (ValueError, KeyError) as e:
        print(f"Error parsing JSON: {e}")
        return

    results = set()
    for writeup in writeups:
        if any(search_term in bug.lower() for bug in writeup.get("Bugs", [])):
            for link_dict in writeup.get("Links", []):
                results.add(link_dict.get("Link"))
        # Search in "Title" field
        for link_dict in writeup.get("Links", []):
            if search_term in link_dict.get("Title", "").lower():
                results.add(link_dict.get("Link"))
    
    for result in results:
        print(result)

if __name__ == "__main__":
    main()